#!/bin/sh

set -e

echo Generating file tree...
mkdir -p rootdir/libexec/scc
mkdir -p rootdir/bin

if test ! -e config.mk
then
	printf '%s\n' 'Generating config.mk from defaults...' \
	              '(edit it for customization and then re-run this script)'
	trap "rm -f $$.mk" 0 2 3
	(cat config.mk.def
	sed -n '/^# '`uname`'/,/^$/p' system.mk) > $$.mk &&
	mv $$.mk config.mk
fi

echo Generating arch-dependant build files...
make dep > /dev/null

echo You can now install scc with \"make install\"
